import random

from deepteam.attacks import BaseAttack
from deepteam.attacks.agentic.domain_exploitation.template import DomainExploitationTemplate


class DomainExploitation(BaseAttack):
    def __init__(self, weight: int = 2):
        self.weight = weight  # Higher weight since this targets domain-specific vulnerabilities

    def enhance(self, attack: str) -> str:
        """
        Enhance the given attack with domain exploitation techniques.
        Randomly selects from different context-specific hallucination methods.
        """
        return random.choice([
            DomainExploitationTemplate.enhance_domain_mimicry(attack),
            DomainExploitationTemplate.enhance_specialized_terminology(attack),
            DomainExploitationTemplate.enhance_knowledge_gap_exploitation(attack),
            DomainExploitationTemplate.enhance_credibility_manipulation(attack),
            DomainExploitationTemplate.enhance_context_confusion(attack),
        ])

    def get_name(self) -> str:
        return "Domain Exploitation" 